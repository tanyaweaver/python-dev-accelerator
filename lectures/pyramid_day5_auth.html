<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Controlling Access &mdash; Python 401 2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python 401 2.1 documentation" href="../index.html" />
    <link rel="up" title="Monday" href="../schedule/week04/mon.html" />
    <link rel="next" title="Tuesday" href="../schedule/week04/tue.html" />
    <link rel="prev" title="Graph Traversal: Depth First Search" href="graph_traversal_dfs.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />

<link rel="stylesheet" href="../_static/custom.css" type="text/css" media="screen" charset="utf-8" />

<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/cf_logo.png" alt="Logo"/>
      <p>Code Fellows</p>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../schedule/week04/tue.html" title="Tuesday"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="graph_traversal_dfs.html" title="Graph Traversal: Depth First Search"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../schedule/week04/mon.html" accesskey="U">Monday</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="controlling-access">
<h1>Controlling Access<a class="headerlink" href="#controlling-access" title="Permalink to this headline">¶</a></h1>
<p>One thing you may have noticed while testing your app in a browser is that you did not have to log in.
Convenient, but not really all that safe.
Knowing the kind of place the internet is,
you probably don&#8217;t want to allow just anyone to post journal entries in your journal.</p>
<p>The process of verifying the identity of a user visiting your website is called <strong>authentication</strong> (AuthN for short).
The closely related, but different process of determining what <em>rights</em> an authenticated user has in your website
is called <strong>authorization</strong> (AuthZ).</p>
<p>Next, we&#8217;ll be adding <em>authentication</em> and <em>authorization</em> to your journal.
This will allow you to display entries to the general public while reserving the ability to write new entries to a known user (you).</p>
<div class="section" id="principals">
<h2>Principals<a class="headerlink" href="#principals" title="Permalink to this headline">¶</a></h2>
<p>Both AuthN and AuthZ depend on identity.
In a website, Identity is tied to the concept of <em>principals</em>.
Principals can be called users, groups, roles, or any of a number of other names.
But behind them all stands the basic idea of an identifier that can be used for both authentication and authorization.</p>
<p>For the purposes of a single-user learning journal, we won&#8217;t really need to be too complicated.
A <em>user</em> is probably enough to get the job done.</p>
<p>You could implement an entire database table for the purpose of storing your user information,
but really that&#8217;s overkill for a system that only has one user.
You should never implement more code than you need.</p>
<p>So how can you solve the problem of storing the data needed to authenticate a single user?</p>
<p>How about <em>configuration</em>?</p>
<p>You remember that we&#8217;ve been using <code class="docutils literal"><span class="pre">os.environ</span></code> to hold the URL for our database connection.
We can do the same thing for an identifier (<em>principal</em>) representing our user.
We&#8217;ll call this principal a <em>username</em></p>
<div class="build highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_USERNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>What else would we require in order to prove that a user is who they claim to be?
Generally, this is done by asking the user to provide a <em>password</em>.
If the password provided by the user matches the one stored by the system,
then the user has proven their identity.
We can use the same mechanism to store our one user&#8217;s password:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="policies">
<h2>Policies<a class="headerlink" href="#policies" title="Permalink to this headline">¶</a></h2>
<p>To <em>authenticate</em> a user, the most basic pattern is to confirm a username and password.
In general the steps are to:</p>
<ul class="build simple">
<li>accept a username and password as provided by a visitor</li>
<li>reject them if either is missing</li>
<li>reject them if they cannot be confirmed to be correct</li>
<li>otherwise, persist the fact that the user is authenticated</li>
</ul>
<p>HTTP is a <strong>stateless</strong> protocol.
That means that no individual request can know anything about any other request.
So how do you accomplish that fourth goal?
The usual method is to send an encrypted <em>cookie</em> back to the user in an HTTP response.
This cookie is saved and re-transmitted to the server with each successive request.
This gets around the <em>stateless</em> nature of HTTP by sending the required information back and forth.</p>
<p>By default, Pyramid does not enable authentication.
There are a lot of use-cases for building an application that does not require any login.
Our application really does need it, though, so we&#8217;ll need to enable AuthN and AuthZ</p>
<p>In pyramid, both AuthN and AuthZ are implemented using <em>policies</em>.
These <em>policies</em> are classes with a specific set of methods and attributes that fulfill a required contract.</p>
<p>Policies for AuthN are made available in the <a class="reference external" href="http://docs.pylonsproject.org/docs/pyramid/en/latest/api/authentication.html">pyramid.authentication</a> package.
For our authentication policy we&#8217;ll be using the <code class="docutils literal"><span class="pre">AuthTktAuthenticationPolicy</span></code>.
This policy issues an encrypted, <a class="reference external" href="http://stackoverflow.com/questions/1844623/what-is-the-auth-tkt-cookie-format">specially formatted cookie</a> to the user&#8217;s browser.
Whenever a new request comes in,
Pyramid unencrypts the cookie and establishes the identity of the user from the data it contains.</p>
<p>To enable authentication we must <em>configure</em> our app to include an authentication policy.
We could do this in our apps <code class="docutils literal"><span class="pre">__init__.py</span></code> file, but we&#8217;ve been following a pattern of breaking related configuration into separate modules.
We&#8217;ll <em>include</em> this module in our app <code class="docutils literal"><span class="pre">__init__.py</span></code>.
So it will need an <code class="docutils literal"><span class="pre">includeme</span></code> function:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># security.py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pyramid.authentication</span> <span class="kn">import</span> <span class="n">AuthTktAuthenticationPolicy</span>


<span class="k">def</span> <span class="nf">includeme</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;security-related configuration&quot;&quot;&quot;</span>
    <span class="n">auth_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;itsaseekrit&#39;</span><span class="p">)</span>
    <span class="n">authn_policy</span> <span class="o">=</span> <span class="n">AuthTktAuthenticationPolicy</span><span class="p">(</span>
        <span class="n">secret</span><span class="o">=</span><span class="n">auth_secret</span><span class="p">,</span>
        <span class="n">hashalg</span><span class="o">=</span><span class="s1">&#39;sha512&#39;</span>
    <span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authentication_policy</span><span class="p">(</span><span class="n">authn_policy</span><span class="p">)</span>
</pre></div>
</div>
<p>We can use the OS environment pattern we&#8217;ve been establishing to get a <strong>auth_secret</strong>.
This value will serve as a <em>key</em> for encrypting and decrypting the cookie sent back and forth from the client.
Then, we create an instance of the <code class="docutils literal"><span class="pre">AuthTktAuthenticationPolicy</span></code> class,
initialized with our secret and with the name of the algorithm we&#8217;ll use to perform the encryption.
Finally, we set this instance as the authentication policy for our app configuration.</p>
<p>Once you know <em>who</em> someone is, you will also want to know <em>what rights</em> they should be given in your website.
Pyramid provides for this through an <strong>Authorization Policy</strong>.
There is a version of such a policy made available in the <a class="reference external" href="http://docs.pylonsproject.org/docs/pyramid/en/latest/api/authorization.html">pyramid.authorization</a> package.
It&#8217;s called the <code class="docutils literal"><span class="pre">ACLAuthorizationPolicy</span></code>.
It works by allowing you to specify permissions that should be granted or denied to certain principals.</p>
<p>To enable this policy, we must add configuration to our new <code class="docutils literal"><span class="pre">security.py</span></code> module:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># security.py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pyramid.authentication</span> <span class="kn">import</span> <span class="n">AuthTktAuthenticationPolicy</span>
<span class="kn">from</span> <span class="nn">pyramid.authorization</span> <span class="kn">import</span> <span class="n">ACLAuthorizationPolicy</span>

<span class="k">def</span> <span class="nf">includeme</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;security-related configuration&quot;&quot;&quot;</span>
    <span class="n">auth_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;itsaseekrit&#39;</span><span class="p">)</span>
    <span class="n">authn_policy</span> <span class="o">=</span> <span class="n">AuthTktAuthenticationPolicy</span><span class="p">(</span>
        <span class="n">secret</span><span class="o">=</span><span class="n">auth_secret</span><span class="p">,</span>
        <span class="n">hashalg</span><span class="o">=</span><span class="s1">&#39;sha512&#39;</span>
    <span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authentication_policy</span><span class="p">(</span><span class="n">authn_policy</span><span class="p">)</span>
    <span class="c1"># add the following new lines of configuration and the new import above.</span>
    <span class="n">authz_policy</span> <span class="o">=</span> <span class="n">ACLAuthorizationPolicy</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authorization_policy</span><span class="p">(</span><span class="n">authz_policy</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have a policy for AuthN and AuthZ configured, we can include our security module in our global app configuration.
Back in our <code class="docutils literal"><span class="pre">__init__.py</span></code>, let&#8217;s include it:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># __init__.py</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">global_config</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function returns a Pyramid WSGI application.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_jinja2&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;.models&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;.routes&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;.security&#39;</span><span class="p">)</span> <span class="c1">#&lt;-- add this</span>
    <span class="n">config</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="permissions">
<h2>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h2>
<p>Once policies have been configured for authentication and authorization,
we are ready to make assertions about what <em>permissions</em> we want to require for our views.</p>
<p>Once again, Pyramid does not, by default, require any permissions for any views.
There are many applications where none are required.
But our app should.
We can start by setting a <em>default</em> permission,
one that will be used for all views.
We can use the <code class="docutils literal"><span class="pre">set_default_permission</span></code> method of the Configuration class:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">includeme</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;security-related configuration&quot;&quot;&quot;</span>
    <span class="n">auth_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;itsaseekrit&#39;</span><span class="p">)</span>
    <span class="n">authn_policy</span> <span class="o">=</span> <span class="n">AuthTktAuthenticationPolicy</span><span class="p">(</span>
        <span class="n">secret</span><span class="o">=</span><span class="n">auth_secret</span><span class="p">,</span>
        <span class="n">hashalg</span><span class="o">=</span><span class="s1">&#39;sha512&#39;</span>
    <span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authentication_policy</span><span class="p">(</span><span class="n">authn_policy</span><span class="p">)</span>
    <span class="c1"># add the following new lines of configuration and the new import above.</span>
    <span class="n">authz_policy</span> <span class="o">=</span> <span class="n">ACLAuthorizationPolicy</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authorization_policy</span><span class="p">(</span><span class="n">authz_policy</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, all our views will require that our visitor has a permission called <code class="docutils literal"><span class="pre">'view'</span></code> before they will display.
If the visitor does not have the required permission, Pyramid will automatically raise a <code class="docutils literal"><span class="pre">403</span> <span class="pre">Forbidden</span></code> error.</p>
<p>We can also set permissions on individual views.
We use the <code class="docutils literal"><span class="pre">view_config</span></code> decorator to do so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;private&#39;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="n">permission</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">private</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;I am a private view&quot;</span>
</pre></div>
</div>
<p>When we use the <code class="docutils literal"><span class="pre">permission</span></code> keyword argument to <code class="docutils literal"><span class="pre">view_config</span></code>,
the decorated view will require that the <em>principal</em> who has made a request for this view has the named permission.
If we have set a default permission in our security configuration, that permission will be <em>overridden</em> by this new one.</p>
<p>Any view that is not marked with permission will use the default permission we configured.
If we configured no default, then no permission will be required.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">public</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;I am a public view&quot;</span>
</pre></div>
</div>
<p>As we have said, declaring a default permission means <em>every</em> view that does not explicitly require a permission will require the default.
If you need to exempt a view from this requirement, Pyramid provides a special marker.
You can use <code class="docutils literal"><span class="pre">pyramid.security.NO_PERMISSION_REQUIRED</span></code> as the permission argument to your <cite>view_config</cite> decorator:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.security</span> <span class="kn">import</span> <span class="n">NO_PERMISSION_REQUIRED</span>

<span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="n">permission</span><span class="o">=</span><span class="n">NO_PERMISSION_REQUIRED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># log in a user</span>
</pre></div>
</div>
<div class="section" id="permissions-context-and-acls">
<h3>Permissions, Context and ACLs<a class="headerlink" href="#permissions-context-and-acls" title="Permalink to this headline">¶</a></h3>
<p>In Pyramid, <em>views</em> are responsible for requiring a permission.
But how do we determine what permissions are assigned to a specific <em>principal</em>?
That is a task that falls to <em>context</em>.</p>
<p>Context is best defined as <em>where you are</em> in an application.
In a basic Pyramid app, context is provided by a <em>root</em> object.
The root object is created when an incoming request is handled.
A <em>root factory</em> is a class that can be instantiated with a request.
A specific instance of the <em>root factory</em> serves as the root for a given request.</p>
<p>When a visitor to a site requests a particular view, the Pyramid framework inspects the configuration of that view to determine which permission is required.
Then the framework finds the root object and asks it for information about what permissions are granted to the current <em>principal</em>.
The root object must provide an <code class="docutils literal"><span class="pre">__acl__</span></code> special attribute.</p>
<p>An ACL is an <em>access control list</em>.
It is expressed as a list of tuples, each of which specifies a relationship between a principal and a permission.
Each tuple contains exactly three values:</p>
<ul class="simple">
<li>An action (one of <code class="docutils literal"><span class="pre">pyramid.security.Allow</span></code> or <code class="docutils literal"><span class="pre">pyramid.security.Deny</span></code>)</li>
<li>A <em>principal</em> (a string or special value that is matched against the current principal)</li>
<li>A <em>permission</em> (a string or special value that is matched against the required permission)</li>
</ul>
<p>The <em>principal</em> in an ACL tuple may be a simple string, like a username.
Or it might be one of two special values provided by the framework.
The <code class="docutils literal"><span class="pre">pyramid.security</span></code> module provides <code class="docutils literal"><span class="pre">Everyone</span></code> to represent any principal at all.
And <code class="docutils literal"><span class="pre">Authenticated</span></code> is provided to represent anyone who has passed an authentication check by the authentication policy.</p>
<p>The <em>permission</em> in an ACL tuple will generally be a simple string.
It should match one of the permissions configured for views,
or the permission set as the default permission for the app.
These strings are arbitrary, you can make up permissions that fit your needs.
Alternantively, the <code class="docutils literal"><span class="pre">pyramid.security</span></code> module provides the special value <code class="docutils literal"><span class="pre">ALL_PERMISSIONS</span></code>.
This value will match any permission required, and can be use to grant blanket access to any view.</p>
<p>If the current principal for a request is found in a tuple with the required permission,
and the action in that tuple is <code class="docutils literal"><span class="pre">Allow</span></code>,
then the view can be called.
If no tuple is found, or one is found where the action is <code class="docutils literal"><span class="pre">Deny</span></code>,
then the framework will automatically raise a <code class="docutils literal"><span class="pre">403</span> <span class="pre">Forbidden</span></code> exception.</p>
<p>ACLs are found on roots, which are built using root factories.
Pyramid provides a default root factory.
It does not have any <code class="docutils literal"><span class="pre">__acl__</span></code>,
so unless we replace it no-one will be allowed to request any view which requires a permission.
We can replace the default factory in our <code class="docutils literal"><span class="pre">security.py</span></code> module.
We create a root factory class that takes the request as an argument for initialization,
and provides an <code class="docutils literal"><span class="pre">__acl__</span></code> special attribute with appropriate ACL entries:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># in security.py</span>

<span class="kn">from</span> <span class="nn">pyramid.security</span> <span class="kn">import</span> <span class="n">Everyone</span><span class="p">,</span> <span class="n">Authenticated</span>
<span class="kn">from</span> <span class="nn">pyramid.security</span> <span class="kn">import</span> <span class="n">Allow</span>

<span class="k">class</span> <span class="nc">MyRoot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">request</span>

    <span class="n">__acl__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="n">Everyone</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="s1">&#39;secret&#39;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>Then, we set this as the root factory for our app in <code class="docutils literal"><span class="pre">includeme</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">includeme</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;security-related configuration&quot;&quot;&quot;</span>
    <span class="n">auth_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_SECRET&#39;</span><span class="p">,</span> <span class="s1">&#39;itsaseekrit&#39;</span><span class="p">)</span>
    <span class="n">authn_policy</span> <span class="o">=</span> <span class="n">AuthTktAuthenticationPolicy</span><span class="p">(</span>
        <span class="n">secret</span><span class="o">=</span><span class="n">auth_secret</span><span class="p">,</span>
        <span class="n">hashalg</span><span class="o">=</span><span class="s1">&#39;sha512&#39;</span>
    <span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authentication_policy</span><span class="p">(</span><span class="n">authn_policy</span><span class="p">)</span>
    <span class="n">authz_policy</span> <span class="o">=</span> <span class="n">ACLAuthorizationPolicy</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authorization_policy</span><span class="p">(</span><span class="n">authz_policy</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_root_factory</span><span class="p">(</span><span class="n">MyRoot</span><span class="p">)</span> <span class="c1">#&lt;-- add this line</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="authenticating-users">
<h2>Authenticating Users<a class="headerlink" href="#authenticating-users" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve now secured a simple application.
We allow anyone to request views that have no specific permission declaration.
And we require that a user be authenticated in order to view our private view.
All that remains is to allow a user to authenticate.</p>
<p>We stated at the beginning that we would use the OS environment to store a username and password.
We could implement a model for our user, but since we&#8217;ll only need one, it&#8217;s a bit of overkill to do so.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_USERNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Given this plan, we can implement a simple function that would allow us to authenticate a user.
It will take as arguments the username and password provided by a visitor.
Then it will compare these against the values we stored in the environment.
If they match, then we know the user is who they claim to be.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">check_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="n">stored_username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_USERNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">stored_password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">is_authenticated</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">stored_username</span> <span class="ow">and</span> <span class="n">stored_password</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="n">stored_username</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">password</span> <span class="o">==</span> <span class="n">stored_password</span><span class="p">:</span>
                <span class="n">is_authenticated</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="n">is_authenticated</span>
</pre></div>
</div>
<p>This would work, but there&#8217;s a critical flaw in our plan.
Can you spot it?</p>
<div class="section" id="encryption">
<h3>Encryption<a class="headerlink" href="#encryption" title="Permalink to this headline">¶</a></h3>
<p>The problem is that our password is being stored in plain text.
If anyone breaks into our server, they will be able to read the password.
We should prevent this.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>NEVER</strong> store user passwords in plain text.</p>
</div>
<p>Passwords should always be stored in a hashed form.
This means that we should put the plain text password through a one-way algorithm that changes it in a way we cannot undo.
When the user provides their password, we put it through the same algorithm.
If the result matches the hashed value we stored, then the starting point must have been the same.
The passwords are matched, and the user has proven their identity.</p>
<p>There are a number of libraries in Python that can help us solve this problem.
I recommend one called <code class="docutils literal"><span class="pre">passlib</span></code>.
It provides a clear, uncomplicated API both for hashing a plain-text password and verifying a plain-text password against the hashed version.
The library uses a single object called a <em>context</em> to implement this API.
The context can be configured to use any of a number of different hashing algorithms.
It can even be configured to transition from one algorithm to another over time.
It is quite sophisticated.</p>
<p>Let&#8217;s create a context for our app to use, as instructed by the <a class="reference external" href="https://pythonhosted.org/passlib/new_app_quickstart.html">passlib quickstart documentation</a>:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># in security.py</span>

<span class="kn">from</span> <span class="nn">passlib.apps</span> <span class="kn">import</span> <span class="n">custom_app_context</span> <span class="k">as</span> <span class="n">pwd_context</span>
</pre></div>
</div>
<p>This <cite>pwd_context</cite> object provides two useful methods.
The <code class="docutils literal"><span class="pre">encrypt</span></code> method returns a hashed version of the provided password.
The <code class="docutils literal"><span class="pre">verify</span></code> method takes a plain-text password and a hash and comparies them.</p>
<p>We can store a hashed version of our password in the environment:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pwd_context</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="s1">&#39;secret password&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>And we can verify the encrypted result against provided password:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="n">hashed</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">verify</span><span class="p">(</span><span class="s1">&#39;secret password&#39;</span><span class="p">,</span> <span class="n">hashed</span><span class="p">)</span> <span class="c1">#&lt;-- returns True</span>

<span class="n">verify</span><span class="p">(</span><span class="s1">&#39;not my password&#39;</span><span class="p">,</span> <span class="n">hashed</span><span class="p">)</span> <span class="c1">#&lt;-- returns False</span>
</pre></div>
</div>
<p>If we make the assumption that the password stored in our OS environment is encrypted,
we can write a more secure version of our <code class="docutils literal"><span class="pre">check_credentials</span></code> function.</p>
<p>Add the following to our <code class="docutils literal"><span class="pre">security.py</span></code> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># in security.py</span>

<span class="kn">from</span> <span class="nn">passlib.apps</span> <span class="kn">import</span> <span class="n">custom_app_context</span> <span class="k">as</span> <span class="n">pwd_context</span>

<span class="k">def</span> <span class="nf">check_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="n">stored_username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_USERNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">stored_password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AUTH_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">is_authenticated</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">stored_username</span> <span class="ow">and</span> <span class="n">stored_password</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="n">stored_username</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">is_authenticated</span> <span class="o">=</span> <span class="n">pwd_context</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">stored_password</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># ValueError is raised if the stored password is not hashed</span>
                <span class="k">pass</span>
    <span class="k">return</span> <span class="n">is_authenticated</span>
</pre></div>
</div>
<p>Remember, because we&#8217;ve now written code that depends on the <code class="docutils literal"><span class="pre">passlib</span></code> library,
we must add that library to our list of dependencies in <code class="docutils literal"><span class="pre">setup.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">requires</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;pyramid&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyramid_jinja2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyramid_debugtoolbar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyramid_tm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SQLAlchemy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;transaction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;zope.sqlalchemy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;waitress&#39;</span><span class="p">,</span>
    <span class="s1">&#39;passlib&#39;</span><span class="p">,</span> <span class="c1">#&lt;-- add this line</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Then re-install your application to pick up the new dependency</p>
</div>
<div class="section" id="logging-in">
<h3>Logging In<a class="headerlink" href="#logging-in" title="Permalink to this headline">¶</a></h3>
<p>Remember the four steps we outlined back at the beginning of our discussion:</p>
<ul class="simple">
<li>accept a username and password as arguments</li>
<li>raise an appropriate error if either is missing</li>
<li>raise an appropriate error if they cannot be confirmed to be correct</li>
<li>persist the fact that the user is authenticated</li>
</ul>
<p>We now have a way to do the first three, but we must write a <em>view</em> to allow a visitor to our site to access this functionality.
We can then accomplish the last step, by adding an appropriate cookie to the response we send back.
Then, each time that visitor requests a page, the fact that they have authenticated will be remembered.
And we&#8217;ll be able to allow the visitor access to restricted pages.</p>
<p>Let&#8217;s add this view to our views file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># in views/default.py</span>

<span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPFound</span>
<span class="kn">from</span> <span class="nn">pyramid.security</span> <span class="kn">import</span> <span class="n">remember</span><span class="p">,</span> <span class="n">forget</span>
<span class="kn">from</span> <span class="nn">test_transactions.security</span> <span class="kn">import</span> <span class="n">check_credentials</span>

<span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;templates/login.jinja2&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="n">remember</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HTTPFound</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{}</span>
</pre></div>
</div>
<p>We can also create a simple template to serve as our login form:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="x">&lt;!-- templates/login.jinja2 --&gt;</span>

<span class="x">&lt;h2&gt;Login&lt;/h2&gt;</span>
<span class="x">&lt;form action=&quot;&quot; method=&quot;POST&quot;&gt;</span>
<span class="x">&lt;div class=&quot;field&quot;&gt;</span>
<span class="x">    &lt;label for=&quot;username&quot;&gt;Username&lt;/label&gt;</span>
<span class="x">    &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot;/&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;div class=&quot;field&quot;&gt;</span>
<span class="x">    &lt;label for=&quot;password&quot;&gt;Password&lt;/label&gt;</span>
<span class="x">    &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot;/&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;div class=&quot;control_row&quot;&gt;</span>
<span class="x">    &lt;input type=&quot;submit&quot; name=&quot;Login&quot; value=&quot;Login&quot;/&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/form&gt;</span>
</pre></div>
</div>
<p>Our login view is a typical form-handling view.
If the request method is not &#8220;POST&#8221;, then no form handling is performed, and the form template is rendered with an empty context.
But if the request method <em>is</em> &#8220;POST&#8221;, the username and password provided by the visitor are read.
The values are verified using our <code class="docutils literal"><span class="pre">check_credentials</span></code> function.</p>
<p>If the credentials the visitor provided check out,
then we can use the <code class="docutils literal"><span class="pre">remember</span></code> function from the <code class="docutils literal"><span class="pre">pyramid.security</span></code> module.
This function uses the authorization policy we have configured to create headers to set an <code class="docutils literal"><span class="pre">auth_tkt</span></code> cookie to send back to the visitor.
We can then redirect the visitor to the home page, adding these headers to the response.
Subsequent requests from this visitor will include this cookie, and our application will be aware that this visitor is authenticated.</p>
<p>Once this is done, then <code class="docutils literal"><span class="pre">request.authenticated_userid</span></code> will return the username we passed to the <code class="docutils literal"><span class="pre">remember</span></code> function.
We can use this to perform checks in page templates.
We can show or hide HTML elements based on whether there is an authenticated user.</p>
</div>
<div class="section" id="logging-out">
<h3>Logging Out<a class="headerlink" href="#logging-out" title="Permalink to this headline">¶</a></h3>
<p>We should also provide a mechanism for de-authenticating ourselves.
If we don&#8217;t then a visitor to our site using a public computer might leave behind a browser with access to the site.</p>
<p>To log out, we need to implement a view that removes the cookie that is used to persist our authentication information.
Once this cookie is gone, then subsequent requests to the site will no longer contain information needed to prove authenication.
Requests for views that require permissions will again cause <code class="docutils literal"><span class="pre">403</span> <span class="pre">Forbidden</span></code> errors.</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="c1"># in views/default.py</span>

<span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;logout&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">forget</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HTTPFound</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that we need not provide any renderer for this view.
It will never return a response that can be viewed by a visitor.</p>
<p>Finally, to make this all work properly, we have to add routes for our login and logout views.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># in routes.py</span>

<span class="k">def</span> <span class="nf">includeme</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;/login&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="s1">&#39;/logout&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="wrap-up">
<h2>Wrap-Up<a class="headerlink" href="#wrap-up" title="Permalink to this headline">¶</a></h2>
<p>In this lecture, we&#8217;ve learned a bit about security in Pyramid apps.
We&#8217;ve learned that we can represent identity using <em>principals</em>.
We&#8217;ve configured an application to use security by adding AuthN and AuthZ <em>policies</em>.
We&#8217;ve seen that we can control access to views by configuring them to require <em>permissions</em>.
And we&#8217;ve seen how we can grant or deny permissions to principals using ACLs, which are found on <em>root objects</em>.</p>
<p>We&#8217;ve seen how we can store authentication information for a single user in our OS environment.
We&#8217;ve learned how to use a Python library to hash and verify our user&#8217;s password.
And we&#8217;ve written the views needed to allow our user to log in and out of our application.</p>
<p>That should be about enough for now.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Controlling Access</a><ul>
<li><a class="reference internal" href="#principals">Principals</a></li>
<li><a class="reference internal" href="#policies">Policies</a></li>
<li><a class="reference internal" href="#permissions">Permissions</a><ul>
<li><a class="reference internal" href="#permissions-context-and-acls">Permissions, Context and ACLs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authenticating-users">Authenticating Users</a><ul>
<li><a class="reference internal" href="#encryption">Encryption</a></li>
<li><a class="reference internal" href="#logging-in">Logging In</a></li>
<li><a class="reference internal" href="#logging-out">Logging Out</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wrap-up">Wrap-Up</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="graph_traversal_dfs.html"
                        title="previous chapter">Graph Traversal: Depth First Search</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../schedule/week04/tue.html"
                        title="next chapter">Tuesday</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../schedule/week04/tue.html" title="Tuesday"
             >next</a> |</li>
        <li class="right" >
          <a href="graph_traversal_dfs.html" title="Graph Traversal: Depth First Search"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../schedule/week04/mon.html" >Monday</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Cris Ewing.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>