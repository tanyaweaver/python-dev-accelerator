<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data Munging &mdash; Python 401 2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python 401 2.1 documentation" href="../index.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />

<link rel="stylesheet" href="../_static/custom.css" type="text/css" media="screen" charset="utf-8" />

<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/cf_logo.png" alt="Logo"/>
      <p>Code Fellows</p>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="data-munging">
<h1>Data Munging<a class="headerlink" href="#data-munging" title="Permalink to this headline">¶</a></h1>
<p>Real world data is rarely clean or well-structured.
The data scientist must know how and when to clean their data, and what it means to even have data that&#8217;s clean.
We&#8217;ll get into that later when we talk about validating your data and accounting for bad rows.</p>
<div class="section" id="pandas">
<h2>Pandas<a class="headerlink" href="#pandas" title="Permalink to this headline">¶</a></h2>
<p>To even begin to clean your data well, it helps to have it well-organized.
<a class="reference external" href="http://pandas.pydata.org/">Pandas</a> is a package that&#8217;s great for keeping your data well organized, giving you access to fast NumPy-like math capabilities with Excel-like access to your data in visible columns and rows.
It accomplishes this through a new data structure called the DataFrame.
DataFrames are fairly easy to build from a standard Python <code class="docutils literal"><span class="pre">dict</span></code>.
Pandas is not part of the Python standard library, so it was included in the <code class="docutils literal"><span class="pre">data_science_requirements.txt</span></code> file that was downloaded yesterday.
If you want to download it yourself for other environments just <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="gp">In [3]: </span><span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;%b </span><span class="si">%d</span><span class="s2">, %Y&quot;</span>

<span class="gp">In [4]: </span><span class="n">finances</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ...: </span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Pablo&quot;</span><span class="p">,</span> <span class="s2">&quot;Marcel&quot;</span><span class="p">,</span> <span class="s2">&quot;Lisa&quot;</span><span class="p">,</span> <span class="s2">&quot;Joanne&quot;</span><span class="p">],</span>
<span class="gp">   ...: </span><span class="s2">&quot;Assets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">110000</span><span class="p">,</span> <span class="mi">230000</span><span class="p">],</span>
<span class="gp">   ...: </span><span class="s2">&quot;Debts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">90000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">],</span>
<span class="gp">   ...: </span><span class="s2">&quot;Updated&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   ...: </span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;Jun 10, 2011&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">),</span>
<span class="gp">   ...: </span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;Dec 30, 2005&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">),</span>
<span class="gp">   ...: </span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;May 4, 2000&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">),</span>
<span class="gp">   ...: </span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;Feb 16, 2007&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">),</span>
<span class="gp">   ...: </span><span class="p">],</span>
<span class="gp">   ...: </span><span class="s2">&quot;Total Rating&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="p">}</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">finances_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">finances</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="k">print</span><span class="p">(</span><span class="n">finances_df</span><span class="p">)</span>
<span class="go">   Assets  Debts    Name  Total Rating    Updated</span>
<span class="go">0  120000  90000   Pablo           3.5 2011-06-10</span>
<span class="go">1   80000  80000  Marcel           2.5 2005-12-30</span>
<span class="go">2  110000  30000    Lisa           4.0 2000-05-04</span>
<span class="go">3  230000  50000  Joanne           5.0 2007-02-16</span>
</pre></div>
</div>
<p>When creating a DataFrame from a dictionary, Pandas takes the keys from the dictionary and turns them into column names.
You can then access the columns in a <code class="docutils literal"><span class="pre">dict</span></code>-like fashion with bracket notation, or in Javascript-like dot notation.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="k">print</span><span class="p">(</span><span class="n">finances_df</span><span class="p">[</span><span class="s2">&quot;Total Rating&quot;</span><span class="p">])</span>
<span class="go">0    3.5</span>
<span class="go">1    2.5</span>
<span class="go">2    4.0</span>
<span class="go">3    5.0</span>
<span class="go">Name: Total Rating, dtype: float64</span>

<span class="gp">In [8]: </span><span class="k">print</span><span class="p">(</span><span class="n">finances_df</span><span class="o">.</span><span class="n">Debts</span><span class="p">)</span>
<span class="go">                                                                       0    90000</span>
<span class="go">1    80000</span>
<span class="go">2    30000</span>
<span class="go">3    50000</span>
<span class="go">Name: Debts, dtype: int64</span>
</pre></div>
</div>
<p>The indices on the left side allow you to access individual rows or a series of rows.
Accessing rows isn&#8217;t as simple as with <code class="docutils literal"><span class="pre">list</span></code>-like objects.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [9]: </span><span class="n">finances_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/indexes/base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">1944</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1945</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1946</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>

<span class="nn">pandas/index.pyx</span> in <span class="ni">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class="nt">()</span>

<span class="nn">pandas/index.pyx</span> in <span class="ni">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class="nt">()</span>

<span class="nn">pandas/hashtable.pyx</span> in <span class="ni">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class="nt">()</span>

<span class="nn">pandas/hashtable.pyx</span> in <span class="ni">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 0

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-9-963331d931f8&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">finances_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/core/frame.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1995</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1996</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1997</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_column</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1998</span> 
<span class="g g-Whitespace">   </span><span class="mi">1999</span>     <span class="k">def</span> <span class="nf">_getitem_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>

<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/core/frame.py</span> in <span class="ni">_getitem_column</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">2002</span>         <span class="c1"># get column</span>
<span class="g g-Whitespace">   </span><span class="mi">2003</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2004</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_item_cache</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2005</span> 
<span class="g g-Whitespace">   </span><span class="mi">2006</span>         <span class="c1"># duplicate columns &amp; possible reduce dimensionality</span>

<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/core/generic.py</span> in <span class="ni">_get_item_cache</span><span class="nt">(self, item)</span>
<span class="g g-Whitespace">   </span><span class="mi">1348</span>         <span class="n">res</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1349</span>         <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1350</span>             <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1351</span>             <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_box_item_values</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1352</span>             <span class="n">cache</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/core/internals.py</span> in <span class="ni">get</span><span class="nt">(self, item, fastpath)</span>
<span class="g g-Whitespace">   </span><span class="mi">3288</span> 
<span class="g g-Whitespace">   </span><span class="mi">3289</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">isnull</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">3290</span>                 <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3291</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3292</span>                 <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">))[</span><span class="n">isnull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)]</span>

<span class="nn">/Users/cewing/projects/training/codefellows/existing_course_repos/python-dev-accelerator/lib/python3.5/site-packages/pandas/indexes/base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">1945</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1946</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1947</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_maybe_cast_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1948</span> 
<span class="g g-Whitespace">   </span><span class="mi">1949</span>         <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>

<span class="nn">pandas/index.pyx</span> in <span class="ni">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class="nt">()</span>

<span class="nn">pandas/index.pyx</span> in <span class="ni">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class="nt">()</span>

<span class="nn">pandas/hashtable.pyx</span> in <span class="ni">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class="nt">()</span>

<span class="nn">pandas/hashtable.pyx</span> in <span class="ni">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 0
</pre></div>
</div>
<p>This raises a <code class="docutils literal"><span class="pre">KeyError</span></code> because it&#8217;s attempting to look at the input &#8220;0&#8221; as a column name.
To access the &#8220;ith&#8221; row, you must use the integer-location indexer on the DataFrame.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">Assets                       120000</span>
<span class="go">Debts                         90000</span>
<span class="go">Name                          Pablo</span>
<span class="go">Total Rating                    3.5</span>
<span class="go">Updated         2011-06-10 00:00:00</span>
<span class="go">Name: 0, dtype: object</span>

<span class="gp">In [11]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">                                                                                                                                                                                                                     Out[11]: </span>
<span class="go">   Assets  Debts    Name  Total Rating    Updated</span>
<span class="go">0  120000  90000   Pablo           3.5 2011-06-10</span>
<span class="go">1   80000  80000  Marcel           2.5 2005-12-30</span>
</pre></div>
</div>
<p>Like <code class="docutils literal"><span class="pre">NumPy</span></code> arrays we can do quick aggregate statistics on individual columns.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [12]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gh">Out[12]: </span><span class="go">135000.0</span>

<span class="gp">In [13]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">Debts</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="go">                  Out[13]: 65000.0</span>

<span class="gp">In [14]: </span><span class="n">finances_df</span><span class="p">[</span><span class="s2">&quot;Total Rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">                                   Out[14]: 2.5</span>

<span class="gp">In [15]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">Updated</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">                                                Out[15]: Timestamp(&#39;2011-06-10 00:00:00&#39;)</span>
</pre></div>
</div>
<p>And math across the entirety of a column.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="n">finances_df</span><span class="o">.</span><span class="n">Assets</span> <span class="o">/</span> <span class="mf">1000.0</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">0    120.0</span>
<span class="go">1     80.0</span>
<span class="go">2    110.0</span>
<span class="go">3    230.0</span>
<span class="go">Name: Assets, dtype: float64</span>
</pre></div>
</div>
<p>Also like <code class="docutils literal"><span class="pre">NumPy</span></code> arrays we can filter based on criteria that yields boolean values.
The major difference though is that our cuts return not just pieces of an array, but pieces of the whole DataFrame.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [17]: </span><span class="n">finances_df</span><span class="p">[</span><span class="n">finances_df</span><span class="o">.</span><span class="n">Assets</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">]</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">   Assets  Debts    Name  Total Rating    Updated</span>
<span class="go">0  120000  90000   Pablo           3.5 2011-06-10</span>
<span class="go">2  110000  30000    Lisa           4.0 2000-05-04</span>
<span class="go">3  230000  50000  Joanne           5.0 2007-02-16</span>
</pre></div>
</div>
<p>This is all well and good, but you&#8217;ll likely want to work with data sets coming in from the outside world.
They will be substantial and hopefully well-structured, and <code class="docutils literal"><span class="pre">Pandas</span></code> can read them for you if the columns are well-separated.
For example, a CSV file like so:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c1"># my_neighborhood_map.csv</span>

City Feature,Common Name,Address,Website,Longitude,Latitude,Location
Alternative Schools,Pathfinder,1901 SW Genesee St,http://www.seattleschools.org/schools/pathfinder/welcome.html,-122.358,47.5636,<span class="s2">&quot;(47.5636, -122.358)&quot;</span>
Alternative Schools,The New School At Southshore,4800 S Henderson St,http://www.seattleschools.org/schools/southshore/,-122.27201,47.52374,<span class="s2">&quot;(47.52374, -122.27201)&quot;</span>
Alternative Schools,Catharine Blaine K-8,2550 34th Ave W,http://www.seattleschools.org/schools/blaine/,-122.399261,47.642257,<span class="s2">&quot;(47.642257, -122.399261)&quot;</span>
Alternative Schools,As <span class="c1">#1 At Pinehurst,11530 12th Ave NE,http://as1web.com/,-122.31466,47.713431,&quot;(47.713431, -122.31466)&quot;</span>
Alternative Schools,Nova,301 21st Ave E,,-122.30524,47.6216,<span class="s2">&quot;(47.6216, -122.30524)&quot;</span>
Alternative Schools,The Center School,305 Harrison,http://www.centerschoolseattle.org,-122.353983,47.622078,<span class="s2">&quot;(47.622078, -122.353983)&quot;</span>
Alternative Schools,Thornton Creek K-8,7711 43rd Ave NE,http://www.seattleschools.org/schools/ae2/,-122.282669,47.685032,<span class="s2">&quot;(47.685032, -122.282669)&quot;</span>
Alternative Schools,Orca K-8,5215 46th Ave S,http://www.orcapta.org,-122.27596,47.55478,<span class="s2">&quot;(47.55478, -122.27596)&quot;</span>
Alternative Schools,South Lake Hs,8601 Rainier Ave S,http://www.seattleschools.org/schools/southlake/,-122.27092,47.52526,<span class="s2">&quot;(47.52526, -122.27092)&quot;</span>
Alternative Schools,Madrona K-8,1121 33rd Ave,http://www.seattleschools.org/schools/madrona/,-122.290868,47.612237,<span class="s2">&quot;(47.612237, -122.290868)&quot;</span>
Alternative Schools,Salmon Bay,1810 NW 65th St,http://www.salmonbayschool.org/,-122.38051,47.676298,<span class="s2">&quot;(47.676298, -122.38051)&quot;</span>
Alternative Schools,Tops K-8,2500 Franklin Ave E,http://www.topsk8.org/,-122.324177,47.642286,<span class="s2">&quot;(47.642286, -122.324177)&quot;</span>
Basketball Courts,Hiawatha Playfield,2700 California Ave. SW,http://www.seattle.gov/parks/park_detail.asp?ID<span class="o">=</span>456,-122.38523,47.578526,<span class="s2">&quot;(47.578526, -122.38523)&quot;</span>
Basketball Courts,E.C. Hughes Playground,2805 SW Holden St.,http://www.seattle.gov/parks/park_detail.asp?ID<span class="o">=</span>458,-122.370211,47.532807,<span class="s2">&quot;(47.532807, -122.370211)&quot;</span>
Basketball Courts,Bryant Playground,4103 NE 65th St.,http://www.seattle.gov/parks/park_detail.asp?ID<span class="o">=</span>482,-122.283764,47.675545,<span class="s2">&quot;(47.675545, -122.283764)&quot;</span>
...
</pre></div>
</div>
<p>This can be easily read with Pandas:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [18]: </span><span class="n">sample_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;my_neighborhood_map.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If it was separated with anything besides commas, like say tabs, I&#8217;d use</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [19]: </span><span class="n">sample_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;my_neighborhood_map.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the data file itself is a little difficult to read from your shell, use Pandas to tell you stuff about it like what the columns are actually named.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [20]: </span><span class="n">sample_data</span><span class="o">.</span><span class="n">columns</span>
<span class="gh">Out[20]:</span>
<span class="go">Index([&#39;City Feature&#39;, &#39;Common Name&#39;, &#39;Address&#39;, &#39;Website&#39;,</span>
<span class="go">       &#39;Longitude&#39;, &#39;Latitude&#39;, &#39;Location&#39;],</span>
<span class="go">      dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<p>Or how long it is.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [21]: </span><span class="nb">len</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go">2072</span>
</pre></div>
</div>
<p>Or how many Basketball Courts exist in this city.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [22]: </span><span class="nb">sum</span><span class="p">(</span><span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;City Feature&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Basketball Courts&quot;</span><span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">47</span>
</pre></div>
</div>
<p>Pandas provides a great structure for you to investigate a whole data set, instead of trying to read through your file line by line by eye.
We&#8217;re going to use this moving forward to ensure our data is valid, and if it isn&#8217;t then to take some action so that our data is still usable.</p>
</div>
<div class="section" id="what-is-valid">
<h2>What is Valid?<a class="headerlink" href="#what-is-valid" title="Permalink to this headline">¶</a></h2>
<p>When working with a data set, a decent first approximation comes from removing records with invalid information.
You can determine what&#8217;s valid based on auxiliary information about the set, or just from looking at the set itself.
If you&#8217;re looking at data about people and it includes negative ages, those records with negative ages are to some degree invalid.
If your data looks at rental prices of apartments around the city, chances are that prices won&#8217;t be in the 10&#8217;s of thousands of dollars are above.
Whatever the data, think about it, think about values are plausible, and reject those rows with data that fall outside of that realm of plausability.</p>
<p>We&#8217;ll discuss two ways of handling bad data: <strong>removal</strong>, <strong>filling</strong>.
You can also manually alter data, but you had better have a damn good reason to do so.</p>
<div class="section" id="removing-bad-data">
<h3>Removing Bad Data<a class="headerlink" href="#removing-bad-data" title="Permalink to this headline">¶</a></h3>
<p>Maybe the data got corrupted on entry?
Perhaps some records aren&#8217;t relevant to the question at hand.
Whatever the case, sometimes you just need to be able to filter out what you don&#8217;t want.</p>
<p>Note that this <strong>doesn&#8217;t</strong> mean that you should <em>DELETE</em> data.
Your data is your data, whether it&#8217;s good or not.
It&#8217;s valuable in some way, shape, or form, and to artificially remove data in its entirety is an unacceptable practice.
When you filter out information, you must say why and how otherwise your analysis is seen as questionable at best.</p>
<p>Let&#8217;s say that we have the following data set.</p>
<div class="highlight-ipython:"><div class="highlight"><pre>In [23]: print(data)
         ages    heights
0   -1.000000  61.623766
1   34.850545  61.231887
2   -1.000000  62.012366
3   -1.000000  60.776548
4   -1.000000  71.331092
5   32.454987  70.932109
6   34.324364  70.600538
7   28.425111  66.755211
8   -1.000000  61.205107
9   -1.000000  69.932608
10  32.226644  70.130044
11  34.633665  70.428263
12  35.582740  68.087174
13  39.245149  69.507355
14  39.364419  71.366009
15  35.780590  61.853659
16  -1.000000  66.879470
17  -1.000000  66.495248
18  -1.000000  60.654402
19  -1.000000  63.833324
20  -1.000000  71.715755
...
</pre></div>
</div>
<p>Clearly, folks shouldn&#8217;t have negative ages, and those entries would be useless for an analysis of ages or ages vs heights.
Recall from the previous section that we can filter out rows in Pandas fairly easily.</p>
<div class="highlight-ipython:"><div class="highlight"><pre>In [24]: print(data[data.ages != -1])
         ages    heights
1   34.850545  61.231887
5   32.454987  70.932109
6   34.324364  70.600538
7   28.425111  66.755211
10  32.226644  70.130044
11  34.633665  70.428263
12  35.582740  68.087174
13  39.245149  69.507355
14  39.364419  71.366009
15  35.780590  61.853659
22  34.967948  66.308030
23  26.754890  70.697276
24  39.388898  70.603496
27  40.060202  71.432532
29  42.883102  67.030701
32  30.602126  63.557139
36  37.374404  67.276436
40  43.892979  61.926341
41  38.357550  67.625260
42  28.814544  65.478372
46  31.351512  66.442712
47  36.443522  69.275935
</pre></div>
</div>
<p>You can assign this filtered DataFrame to a new variable and then move forward with your analysis from there.
If of course you don&#8217;t care about the ages, then you could go with the data as it was and think about your heights.</p>
</div>
<div class="section" id="making-assumptions-on-bad-data">
<h3>Making Assumptions on Bad Data<a class="headerlink" href="#making-assumptions-on-bad-data" title="Permalink to this headline">¶</a></h3>
<p>Data tends to come in bad.
However, we may not want to just throw it out wholesale; there may be some portions of bad data that are entirely valid.
As an example, I have the following information in a file called &#8220;nmhw_sample_data.csv&#8221;:</p>
<div class="highlight-bash"><div class="highlight"><pre>Name,Age,Hometown,Country,Desired Income,Favorite Food,Number of Cats
James,22,New York,,75000,,0
Bob,25,Seattle,USA,0,pad thai,2
Annette,28,San Francisco,USA,,spaghetti,1
Florence,23,Beijing,China,60000,xiaolong bao,4
Martha,30,Kansas City,,,corn,3
Desean,27,Newark,USA,85000,,
Jamal,28,New York,,65000,pizza,3
Kaede,31,Kyoto,Japan,65000,sushi,4
Milton,23,Austin,,78000,bbq,
Ivana,29,Moscow,Russia,,borscht,1
Jorge,35,Rio de Janeiro,Brasil,90000,farofa,2
</pre></div>
</div>
<p>If I were to read it in as-is, I&#8217;d get the following</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [25]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./downloads/nmhw_sample_data.csv&quot;</span><span class="p">)</span>

<span class="gp">In [26]: </span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">        Name  Age        Hometown Country  Desired Income Favorite Food  Number of Cats</span>
<span class="go">0      James   22        New York     NaN         75000.0           NaN             0.0</span>
<span class="go">1        Bob   25         Seattle     USA             0.0      pad thai             2.0</span>
<span class="go">2    Annette   28   San Francisco     USA             NaN     spaghetti             1.0</span>
<span class="go">3   Florence   23         Beijing   China         60000.0  xiaolong bao             4.0</span>
<span class="go">4     Martha   30     Kansas City     NaN             NaN          corn             3.0</span>
<span class="go">5     Desean   27          Newark     USA         85000.0           NaN             NaN</span>
<span class="go">6      Jamal   28        New York     NaN         65000.0         pizza             3.0</span>
<span class="go">7      Kaede   31           Kyoto   Japan         65000.0         sushi             4.0</span>
<span class="go">8     Milton   23          Austin     NaN         78000.0           bbq             NaN</span>
<span class="go">9      Ivana   29          Moscow  Russia             NaN       borscht             1.0</span>
<span class="go">10     Jorge   35  Rio de Janeiro  Brasil         90000.0        farofa             2.0</span>
</pre></div>
</div>
<p>Those &#8220;NaN&#8221;s are &#8220;Not a Number&#8221;s, the way for Pandas and NumPy to identify missing or otherwise invalid data.
Here, they&#8217;re not consistent across rows.
Some entries have no country, some have no income, etc.
We can make some assumptions about what the missing data should be filled with based on the data that surrounds it.
This works especially well if our data comes in sorted in some way.
Pandas DataFrames have a method &#8220;<code class="docutils literal"><span class="pre">.fillna()</span></code>&#8221; for filling in data in a variety of ways.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [27]: </span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span>
<span class="gh">Out[27]:</span>
<span class="go">        Name  Age        Hometown Country  Desired Income Favorite Food  Number of Cats</span>
<span class="go">0      James   22        New York     NaN         75000.0           NaN             0.0</span>
<span class="go">1        Bob   25         Seattle     USA             0.0      pad thai             2.0</span>
<span class="go">2    Annette   28   San Francisco     USA             0.0     spaghetti             1.0</span>
<span class="go">3   Florence   23         Beijing   China         60000.0  xiaolong bao             4.0</span>
<span class="go">4     Martha   30     Kansas City   China         60000.0          corn             3.0</span>
<span class="go">5     Desean   27          Newark     USA         85000.0          corn             3.0</span>
<span class="go">6      Jamal   28        New York     USA         65000.0         pizza             3.0</span>
<span class="go">7      Kaede   31           Kyoto   Japan         65000.0         sushi             4.0</span>
<span class="go">8     Milton   23          Austin   Japan         78000.0           bbq             4.0</span>
<span class="go">9      Ivana   29          Moscow  Russia         78000.0       borscht             1.0</span>
<span class="go">10     Jorge   35  Rio de Janeiro  Brasil         90000.0        farofa             2.0</span>
</pre></div>
</div>
<p>The above is the result of a &#8220;forward fill&#8221;.
Whatever data came before the invalid entry IN ITS OWN COLUMN will fill that invalid entry in with its own value.</p>
<p>Similarly, there&#8217;s a &#8220;backward fill&#8221;, which fills in missing data with information that comes after.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [28]: </span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bfill&quot;</span><span class="p">)</span>
<span class="gh">Out[28]:</span>
<span class="go">        Name  Age        Hometown Country  Desired Income Favorite Food  Number of Cats</span>
<span class="go">0      James   22        New York     USA         75000.0      pad thai             0.0</span>
<span class="go">1        Bob   25         Seattle     USA             0.0      pad thai             2.0</span>
<span class="go">2    Annette   28   San Francisco     USA         60000.0     spaghetti             1.0</span>
<span class="go">3   Florence   23         Beijing   China         60000.0  xiaolong bao             4.0</span>
<span class="go">4     Martha   30     Kansas City     USA         85000.0          corn             3.0</span>
<span class="go">5     Desean   27          Newark     USA         85000.0         pizza             3.0</span>
<span class="go">6      Jamal   28        New York   Japan         65000.0         pizza             3.0</span>
<span class="go">7      Kaede   31           Kyoto   Japan         65000.0         sushi             4.0</span>
<span class="go">8     Milton   23          Austin  Russia         78000.0           bbq             1.0</span>
<span class="go">9      Ivana   29          Moscow  Russia         90000.0       borscht             1.0</span>
<span class="go">10     Jorge   35  Rio de Janeiro  Brasil         90000.0        farofa             2.0</span>
</pre></div>
</div>
<p>Finally, you can fill in individual columns instead of doing global fills.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [29]: </span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Desired Income&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Desired Income&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<p>Doing the above with a mean or a median gives you plausible values based on the rest of the data set.
This way you can still use all the data in the column and (more or less) not change how it&#8217;s distributed.</p>
<p>Note the above methods have their obvious consequences.
Blindly filling with information can at times produce more data artifacts than you originally had.
Be aware of what you&#8217;re filling with and how you&#8217;re doing it before you go ahead and do it.
Perhaps re-sorting your data would be a better idea before forward or backward-filling.
It&#8217;s never a perfect process, and you should always document what you do and why you do it.
Use the Markdown cells in your Jupyter Notebooks to inject that rationale into your data report.
That way, your choices don&#8217;t seem quite as arbitrary (even if they were entirely arbitrary to begin with).</p>
</div>
</div>
<div class="section" id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">¶</a></h2>
<p>Real data is without fail imperfect.
As analysts, you need to use your chosen language to handle that data before you proceed with your work.
Pandas gives us the tools to handle our data in a structured way, and the methods needed to fill and remove data as need be.</p>
<p>Tonight you will use these methods to clean some data of your own.
Never forget to document your rationale; until you do, only you know why you did what you did.
Keep those intermediate steps in mind while you finalize your report.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data Munging</a><ul>
<li><a class="reference internal" href="#pandas">Pandas</a></li>
<li><a class="reference internal" href="#what-is-valid">What is Valid?</a><ul>
<li><a class="reference internal" href="#removing-bad-data">Removing Bad Data</a></li>
<li><a class="reference internal" href="#making-assumptions-on-bad-data">Making Assumptions on Bad Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recap">Recap</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Cris Ewing.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>